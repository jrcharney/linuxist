#!/bin/bash
# File: dotfiler.sh
# Info: A way to copy the dot files you want to share in a git hub repo.
# TODO: Rewrite this script in Python.

# TODO: make this a herdoc
echo "WARNING! Dotfiler is not set up yet to sanitize dot files"
echo "to remove your personal information from copies of your dot files."
echo "After this script runs, consult the dotfiles directory and make the"
echo "necessary changes to remove all your private stuff before positing"
echo "files you wish to share."
echo "Also, remember, all these files begin with a dot, so they will be"
echo "hidden. If you want to see them, don't forget to use the -a option"
echo "with the ls command."

# Func: ask
# Info: Create a prompt. As a question from input. Return a value. Abort program after three failed attempts.
# Args: $1 = question
# Rets: $ans
# Usge: ans_var=$(ask "Question string?")
ask(){
  local q="${1}"
  local tries=0
  while true; do
    read -p "${q} " ans
    [[ $ans ]] && break
    # TODO: Wasint there some way to do this in one line?
    (( tries++ ))
    [[ $tries -eq 3 ]] && {
      printf "Sorry, I didn't get a valid response after three tries. Aborting.\n"
      exit 1
    }
  done
  echo "${ans}"
}

# TODO: As the user where to put a copy of their files.
#       If they do not respond, use ~/dotfiles
DOTFILE_DIR="${HOME}/dotfiles"
[[ ! -d "${DOTFILE_DIR}" ]] && mkdir ${DOTFILE_DIR}

if [[ ! -d "${DOTFILE_DIR}" ]]; then
  echo "Sorry. We could not find or create ${DOTFILE_DIR}."
  echo "Check to see if you can do that before running this script."
  exit 1
fi

# Check to see if $DOTFILE_DIR is empty if not, ask if you want to overwrite these files. Abort the script if the answer is no.
if [[ ! -z "$(ls -A ${DOTFILE_DIR})" ]]; then
  echo "It looks like there are files in this directory."
  
fi
